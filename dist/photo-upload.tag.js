document.head.insertAdjacentHTML('beforeend', `<template id="photo-upload"><style>:host{--size:200px;--color:#ccc;--background:#fff;display:inline-block;width:var(--size);height:var(--size);background:var(--background)}:host([hidden]){display:none}svg{display:block;width:100%;height:100%;fill:var(--color)}circle-spinner{margin-top:10%;width:80%;height:80%}img{width:100%;height:100%;object-fit:cover}.pulse{animation:pulse 2s linear infinite}@keyframes pulse{from{opacity:.9}50%{opacity:.1}to{opacity:.9}}</style><input id="input" type="file" accept="image/*" hidden><label for="input"><svg id="placeholder" viewbox="0 0 100 100" preserveaspectratio="xMinYMin"><circle cx="50" cy="35" r="25"/><ellipse cx="50" cy="100" rx="45" ry="40"/></svg> <img id="photo" hidden></label></template>`);window.customElements.define('photo-upload',class extends HTMLElement{constructor(){super(),this.attachShadow({mode:'open'}).appendChild(document.querySelector('template#photo-upload').content.cloneNode(true));;}$(a){return this.shadowRoot.querySelector(a)}connectedCallback(){this.input=this.$('input'),this.input.addEventListener('change',this.upload.bind(this)),this.data={}}addData(a){for(var b in a)this.data[b]=a[b]}loadImage(a){var b=new FileReader;b.onload=(a)=>this.setImage(a.target.result),b.readAsDataURL(a)}setImage(a){this.$('img').setAttribute('src',a),this.$('svg').style.display='none',this.$('img').hidden=false}upload(){this.$('svg').style.display='block',this.$('img').hidden=true,this.$('svg').classList.add('pulse');var a=new FormData;for(var b in a.append('photo',this.input.files[0]),this.data)a.append(b,this.data[b]);this.getAttribute('url')&&fetch(this.getAttribute('url'),{method:'POST',body:a}).then((a)=>a.json()).then((a)=>{this.$('svg').classList.remove('pulse'),void 0,a.value&&this.setAttribute('value',a.value),this.dispatchEvent(new CustomEvent('complete',{detail:a})),this.loadImage(this.input.files[0])}),this.loadImage(this.input.files[0])}});